function [A, Br, Bz] = B_field_coil(x, y, z, I, R0)
nu = 8.85418782e-12;
% I = 10e+5;
a = R0;
r = sqrt(x.^2 + y.^2);
A_  = @(a, I, r, z) ...
    (nu./(4.*pi)) .* ((pi.*a.^2 .* I .* r)./(a.^2+r.^2+z.^2).^(3./2)) .* (1+((15.*a.^2.*r.^2)./(8.*(a.^2+r.^2+z.^2).^2)));
Br_ = @(a, I, r, z) ...
    (15.*I.*a.^4.*nu.*r.^3.*z)./(8.*(a.^2 + r.^2 + z.^2).^(9./2)) + (3.*I.*a.^2.*nu.*r.*z.*((15.*a.^2.*r.^2)./(8.*(a.^2 + r.^2 + z.^2).^2) + 1))./(4.*(a.^2 + r.^2 + z.^2).^(5./2));
Bz_ = @(a, I, r, z) ...
    (I.*a.^2.*nu.*((15.*a.^2.*r.^2)./(8.*(a.^2 + r.^2 + z.^2).^2) + 1))./(4.*(a.^2 + r.^2 + z.^2).^(3./2)) - (3.*I.*a.^2.*nu.*r.^2.*((15.*a.^2.*r.^2)./(8.*(a.^2 + r.^2 + z.^2).^2) + 1))./(4.*(a.^2 + r.^2 + z.^2).^(5./2)) - (I.*a.^2.*nu.*r.*((15.*a.^2.*r.^3)./(2.*(a.^2 + r.^2 + z.^2).^3) - (15.*a.^2.*r)./(4.*(a.^2 + r.^2 + z.^2).^2)))./(4.*(a.^2 + r.^2 + z.^2).^(3./2));
% A1 = (nu./(4.*pi)) .* ((pi.*a.^2 .* I .* r)./(a.^2+r.^2+z.^2).^(3./2)) .* (1+((15.*a.^2.*r.^2)./(8.*(a.^2+r.^2+z.^2).^2)));
% A2 = (I.*a.^2.*nu.*r.*((15.*a.^2.*r.^2)./(8.*((z + 10).^2 + a.^2 + r.^2).^2) + 1))./(4.*((z + 10).^2 + a.^2 + r.^2).^(3./2));
A1 = A_(a, I, r, z);
A = A1;
% Br1 = (15.*I.*a.^4.*nu.*r.^3.*z)./(8.*(a.^2 + r.^2 + z.^2).^(9./2)) + (3.*I.*a.^2.*nu.*r.*z.*((15.*a.^2.*r.^2)./(8.*(a.^2 + r.^2 + z.^2).^2) + 1))./(4.*(a.^2 + r.^2 + z.^2).^(5./2));
% Bz1 = (I.*a.^2.*nu.*((15.*a.^2.*r.^2)./(8.*(a.^2 + r.^2 + z.^2).^2) + 1))./(4.*(a.^2 + r.^2 + z.^2).^(3./2)) - (3.*I.*a.^2.*nu.*r.^2.*((15.*a.^2.*r.^2)./(8.*(a.^2 + r.^2 + z.^2).^2) + 1))./(4.*(a.^2 + r.^2 + z.^2).^(5./2)) - (I.*a.^2.*nu.*r.*((15.*a.^2.*r.^3)./(2.*(a.^2 + r.^2 + z.^2).^3) - (15.*a.^2.*r)./(4.*(a.^2 + r.^2 + z.^2).^2)))./(4.*(a.^2 + r.^2 + z.^2).^(3./2));
% Br2 = (15.*I.*a.^4.*nu.*r.^3.*(2.*z + 20))./(16.*((z + 10).^2 + a.^2 + r.^2).^(9./2)) + (3.*I.*a.^2.*nu.*r.*(2.*z + 20).*((15.*a.^2.*r.^2)./(8.*((z + 10).^2 + a.^2 + r.^2).^2) + 1))./(8.*((z + 10).^2 + a.^2 + r.^2).^(5./2));
% Bz2 = (I.*a.^2.*nu.*((15.*a.^2.*r.^2)./(8.*((z + 10).^2 + a.^2 + r.^2).^2) + 1))./(4.*((z + 10).^2 + a.^2 + r.^2).^(3./2)) - (3.*I.*a.^2.*nu.*r.^2.*((15.*a.^2.*r.^2)./(8.*((z + 10).^2 + a.^2 + r.^2).^2) + 1))./(4.*((z + 10).^2 + a.^2 + r.^2).^(5./2)) + (I.*a.^2.*nu.*r.*((15.*a.^2.*r)./(4.*((z + 10).^2 + a.^2 + r.^2).^2) - (15.*a.^2.*r.^3)./(2.*((z + 10).^2 + a.^2 + r.^2).^3)))./(4.*((z + 10).^2 + a.^2 + r.^2).^(3./2));
Br1 = Br_(a, I, r, z);
Bz1 = Bz_(a, I, r, z);
Br = Br1;
Bz = Bz1;
end