function [A, Br, Bz] = B_field_coil(r, z, I, R0)
nu = 8.85418782e-12;
% I = 10e+5;
a = R0;
A1 = (nu./(4.*pi)) .* ((pi.*a.^2 .* I .* r)./(a.^2+r.^2+z.^2).^(3./2)) .* (1+((15.*a.^2.*r.^2)./(8.*(a.^2+r.^2+z.^2).^2)));
A2 = (I.*a.^2.*nu.*r.*((15.*a.^2.*r.^2)./(8.*((z + 10).^2 + a.^2 + r.^2).^2) + 1))./(4.*((z + 10).^2 + a.^2 + r.^2).^(3./2));
A = A1 + A2;
Br1 = (15.*I.*a.^4.*nu.*r.^3.*z)./(8.*(a.^2 + r.^2 + z.^2).^(9./2)) + (3.*I.*a.^2.*nu.*r.*z.*((15.*a.^2.*r.^2)./(8.*(a.^2 + r.^2 + z.^2).^2) + 1))./(4.*(a.^2 + r.^2 + z.^2).^(5./2));
Bz1 = (I.*a.^2.*nu.*((15.*a.^2.*r.^2)./(8.*(a.^2 + r.^2 + z.^2).^2) + 1))./(4.*(a.^2 + r.^2 + z.^2).^(3./2)) - (3.*I.*a.^2.*nu.*r.^2.*((15.*a.^2.*r.^2)./(8.*(a.^2 + r.^2 + z.^2).^2) + 1))./(4.*(a.^2 + r.^2 + z.^2).^(5./2)) - (I.*a.^2.*nu.*r.*((15.*a.^2.*r.^3)./(2.*(a.^2 + r.^2 + z.^2).^3) - (15.*a.^2.*r)./(4.*(a.^2 + r.^2 + z.^2).^2)))./(4.*(a.^2 + r.^2 + z.^2).^(3./2));
Br2 = (15.*I.*a.^4.*nu.*r.^3.*(2.*z + 20))./(16.*((z + 10).^2 + a.^2 + r.^2).^(9./2)) + (3.*I.*a.^2.*nu.*r.*(2.*z + 20).*((15.*a.^2.*r.^2)./(8.*((z + 10).^2 + a.^2 + r.^2).^2) + 1))./(8.*((z + 10).^2 + a.^2 + r.^2).^(5./2));
Bz2 = (I.*a.^2.*nu.*((15.*a.^2.*r.^2)./(8.*((z + 10).^2 + a.^2 + r.^2).^2) + 1))./(4.*((z + 10).^2 + a.^2 + r.^2).^(3./2)) - (3.*I.*a.^2.*nu.*r.^2.*((15.*a.^2.*r.^2)./(8.*((z + 10).^2 + a.^2 + r.^2).^2) + 1))./(4.*((z + 10).^2 + a.^2 + r.^2).^(5./2)) + (I.*a.^2.*nu.*r.*((15.*a.^2.*r)./(4.*((z + 10).^2 + a.^2 + r.^2).^2) - (15.*a.^2.*r.^3)./(2.*((z + 10).^2 + a.^2 + r.^2).^3)))./(4.*((z + 10).^2 + a.^2 + r.^2).^(3./2));
Br = Br1 + Br2;
Bz = Bz1 + Bz2;
end